Hypermail 3.0.0

If you are migrating to 3.0.0 from 2.4.0, please consult the UPGRADE
file.

*** NEW FEATURES

- HTML5

Both the markup generated by hypermail and its documentation have
been updated to HTML5.

- WAI enhancements / deprecation of text-only browser support

The generated markup was reviewed and improved for better screen
reader user experience as well as for the overall accessiblity of
hypermail. Due to the need to use HTML5 and CSS to achieve this goal,
we unfortunately had to stop generating markup that could be readable
and look good in text-only browsers, such as lynx and w3m.

- CSS and hypermail

The CSS rules that used to be inside messages generated by hypermail
have been moved to external files.

You now have the possibility to associate the indexes and messages
with a CSS file to customize their presentation.

You have three configuration options that let you define your own
CSS files:

- "icss_url" : URL of a css file you would like to use only with indexes
- "mcss_url" : URL of a css file you would like to use only with messages
- "default_css_url" : URL of a default CSS file that will be used if
             either gicss_url or mcss_url are not declared. 

If "default_css_url" is not defined and is needed, hypermail will use
the name hypermail.css and will generate this file by itself with some
pre-defined rules, unless this file already exists in the archive
directory.

Hypermail's default css file is also available under
docs/hypermail.css and will be installed with the other documentation
files.

- Navigation bar for messages

Previoulsy hypermail used the same navigation bar for both indexes and
messages.  The new configuration option "mhtmlnavbar2upfile" let's you
include in hypermail generated messages more specific HTML formatting
statement giving links to the hierarchy of your archive. By default,
this option uses the value of "ihtmlnavbar2upfile".

- Deleted messages

If a message has been marked as deleted by means of an annotation, the
thread view will display a "deleted" message, but not remove the
deleted node to avoid having a misinterpreation of threads.  A related
change. the in-reply-to and next in thread messages will display
"deleted message" but won't display the subject of the deleted message
anymore.

- Switch to PCRE2

Up to now hypermail had been using PCRE behind the scenes of its
message filtering options (docs/hmrc.html#filters). PCRE being now
at end of life, and is no longer being actively maintained, we have now
updated hypermail to support its successor, PCRE2. If you were using any
of Hypermail's filtering options, we advise you to check out PCRE2's
doc to see if there have been any changes there that may impact you:

  https://www.pcre.org/current/doc/html/pcre2pattern.html

As before, we're shipping the latest source of PCRE2 with hypermail.
However if your system has PCRE2 installed, hypermail will use that
one when being compiled. At this point of time we're not sure if
shipping this library source is a practice that will be continued in
the future.

- Other configuration option changes

Two new configuration options, "archive_date" and "hypermail_colophon",
allow you choose whether you want to display a line that says when the
archive was generated (only in the indexes) as well as a a line that
states that the archive was generated with hypermail and the
generation date (both in messages and indexes). Both these options may
be considered mutually exclusive as they both display the archive
generation date. You can disable both of them.

"empty_archive_notice" will let you customize the markup and text that
is displayed in indices when you're converting a mbox that consists
exclusively of messages that have been annotated as 'spam' or 'deleted'.

"show_headers_msg_rfc822" will let you customize the list of headers
that you want to be shown in message/rfc822 attachments. If not
defined, hypermail will use the value of "show_headers".

"archived_date" lets you control whether you want to add a line
in the indices giving the date the archive was generated.

Please refer to refer to hmrc.html hmrc.4 or use  hypermail -v for a
more detailed description of the configuration options.

- Parser partially revisited

The parser (a very old source code comment rightfully states this is
the heart of hypermail has been revised and partially rewritten.  We
went from a linear parser output, to an intermediary tree
representation of a message that, after the parsing is completed, is
flattened to the the structure that hypermail print functions are used
to.

This new parser has allowed us to better handle message/rfc822 and
multipart/alternative attachments, simplify hypermail's parsing code,
and use better heuristics for determining the charset that will be
associated with a processed message. The new parser also greatly
simplifies adding new markup changes as it allowed to separate the
parsing from the markup generation.

- Compiler warnings and memory leaks

All compiler warnings generated by gcc -Wall -O2 have been solved.

Although all major runtime cumulative memory leaks that gcc's
-fsanitize and -libasan found were solved, there may be parts of the
code that were not tested as they depend on the use and combination of
different hypermail configuration options.

- Other code improvements

Read the Changelog for more details.

*** DEPRECATED FEATURES

The configuration variable "indextable", which let hypermail
generate message indexes using tables has been deprecated in favor of
using HTML and CSS. This option has been disabled.  The pertaining
code will be removed from the code base in a future release.

The "quotes" and "finequotes" options are now in the to be deprecated
list. The code that handles these options hasn't been updated or
reviewed since a long time and will be deleted in a future release
unless someone gives them more love.

Removed the code that was used for the stand-alone script 'mail'.
This script had security issues and had been disabled in 2003 to stop
working. However, the code and associated libraries were still in
the dist.

*** HYPERMAIL FEATURES THAT NEED MORE LOVE in 3.0.0

This is a list of features that have only been partially updated in
this version.  We are unsure if people are using them and if they
should be preserved or deprecated. If you're using any of these
features, please check that this new version of hypermail is still
working on your archive as expected. If that's not the case, please
stick to the 2.4 version for the moment. Feedback to know if people
are using these features and/or code patches (better) are welcome.

All of these features now have a corresponding issue on hypermail's
github repository, labelled with "support requested", for tracking
their status. If we don't get code patches or feedback, we will
consider deprecating them in the next version of hypermail. Please use
those issue trackers to send your feedback.

- showhtml option: only bare minimum of markup update done. CSS and
  generated markup could be improved. Issue #74 on github.
  
- linkquotes: this piece of code seems to have stopped working at
  least since 2.4.0. This feature has been downgrated to experimental
  and risks being deprecated in the next version of
  hypermail unless someone updates it. Issue #75 on github.
  
- inline html: no specific updates done. The way inline HTML is added
  is very simple (just cut and paste of the attachment's body), and often
  breaks the valid markup that hypermail added. Issue #76 on github.

- yearly and monthly summaries. This features seem to not have been
  updated since long time ago and missing some links letting navigate
  back from a message to the summariess to make them more useful.
  Note that you could add those links with the navbar options. Issue
  #77 on github.
  
- translation of messages: some languagess are behind since years and
  need update. Unmaintained languages risk being dropped out in a
  future version of hypermail. Issue #78 on github.

- compilation: windows LCC support (not updated, seems very
  old). Issue #79 on github.

*** ACKNOWLEDGMENTS

Many thanks to W3C for their contributions to this version of
hypermail. In particular Josh O'Connor, Daniel Montalvo, and Shadi
Abou-Zahra from the WAI Team for their evaluation and feedback on how
to improve hypermail's accessibility; thanks to Vivien Lacourba and
Gerald Oskoboiny from the Systems Team for their testing and feedback
of the pre-release version of hypermail.

Many thanks too to Judy Brewer of the W3C WAI Team as well as Vivien
Lacourba of the W3C Systems Team for their involvement and
facilitating discussions and work on this version of hypermail.

Thanks to Baptiste Daroussin, Jim (@AverageGuy), @cacsar, @schlomif,
and Andy Valencia for their bug reports and code contributions.
